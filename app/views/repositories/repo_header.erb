<%
  #--
  #   Copyright (C) 2012-2013 Gitorious AS
  #
  #   This program is free software: you can redistribute it and/or modify
  #   it under the terms of the GNU Affero General Public License as published by
  #   the Free Software Foundation, either version 3 of the License, or
  #   (at your option) any later version.
  #
  #   This program is distributed in the hope that it will be useful,
  #   but WITHOUT ANY WARRANTY; without even the implied warranty of
  #   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  #   GNU Affero General Public License for more details.
  #
  #   You should have received a copy of the GNU Affero General Public License
  #   along with this program.  If not, see <http://www.gnu.org/licenses/>.
  #++
%><%
header_levels = { :full => 1, :compact => 3 }
header_level = defined?(header_level) && header_level || 1
@body_class = "gts-private" if repository.private?
ref = defined?(ref) && !ref.nil? ? ref : "HEAD"
has_git_backend = repository.ready? && repository.has_commits?
%><div class="gts-site-header" data-gts-env-repository-view-state-path="/users/view_state/repository/<%= repository.id %>.json">
  <div class="container">
    <div class="row">
      <% if !(parent = repository.parent).nil? %>
        <p class="gts-clone-source">
          <i title="Cloned from <%= parent.slug %>" class="icon icon-share-alt"></i>
          Cloned from
          <a href="<%= project_path(parent.project) %>"><%= parent.project.slug %></a> /
          <a href="<%= project_repository_path(parent.project, parent) %>"><%= parent.name %></a>
        </p>
      <% end %>
      <h<%= header_level %> class="span">
        <a href="<%= project_path(project) %>"><%= project.slug %></a> /
        <a class="gts-repository-name-ph" href="<%= project_repository_path(project, repository) %>"><%= repository.name %></a>
      </h<%= header_level %>>
    </div>
    <div class="row">
      <div class="span">
        <%= remote_url_selection(app, repository) %>
      </div>
      <%= repo_action_buttons(app, repository, ref) if has_git_backend %>
    </div>
    <div class="collapse gts-help row" id="repo-url-help">
      <%= clone_help(app, repository) %>
    </div>
    <div class="row gts-description">
      <div class="span gts-repository-description-ph">
        <%= description(repository) %>
      </div>
    </div>
    <% if has_git_backend %>
      <%= repo_navigation(repository, ref, defined?(active) && active) %>
    <% else %>
      <div class="gts-standalone"><p class="gts-repository-admin-ph gts-placeholder"></p></div>
    <% end %>
  </div>
</div>
